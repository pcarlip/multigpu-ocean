[ Info: MPI has not been initialized, so we are calling MPI.Init().
[ Info: MPI has not been initialized, so we are calling MPI.Init().
grid = 512×1024×1024 RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic} on Distributed{GPU{CUDA.CUDAKernels.CUDABackend}} with 3×3×3 halo
├── FullyConnected x ∈ [-3.86538e-18, 50.2655) regularly spaced with Δx=0.0981748
├── Periodic y ∈ [1.87735e-17, 100.531)        regularly spaced with Δy=0.0981748
└── Periodic z ∈ [1.87735e-17, 100.531)        regularly spaced with Δz=0.0981748
grid = 512×1024×1024 RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic} on Distributed{GPU{CUDA.CUDAKernels.CUDABackend}} with 3×3×3 halo
├── FullyConnected x ∈ [50.2655, 100.531) regularly spaced with Δx=0.0981748
├── Periodic y ∈ [1.87735e-17, 100.531)   regularly spaced with Δy=0.0981748
└── Periodic z ∈ [1.87735e-17, 100.531)   regularly spaced with Δz=0.0981748
ERROR: LoadError: ERROR: LoadError: Out of GPU memory trying to allocate 4.094 GiB
Out of GPU memory trying to allocate 4.094 GiB
Effective GPU memory usage: 99.98% (79.231 GiB/79.251 GiB)
Memory pool usage: 78.079 GiB (78.812 GiB reserved)

Stacktrace:
  [1] _pool_alloc
    @ ~/.julia/packages/CUDA/ja0IX/src/memory.jl:666 [inlined]
  [2] macro expansion
    @ ~/.julia/packages/CUDA/ja0IX/src/memory.jl:623 [inlined]
  [3] macro expansion
    @ ./timing.jl:395 [inlined]
  [4] pool_alloc
    @ ~/.julia/packages/CUDA/ja0IX/src/memory.jl:622 [inlined]
  [5] (::CUDA.var"#1140#1142"{CUDA.DeviceMemory, Int64})()
    @ CUDA ~/.julia/packages/CUDA/ja0IX/src/array.jl:92
  [6] cached_alloc(f::CUDA.var"#1140#1142"{CUDA.DeviceMemory, Int64}, key::Tuple{UnionAll, CUDA.CuDevice, DataType, Int64})
    @ GPUArrays ~/.julia/packages/GPUArrays/uiVyU/src/host/alloc_cache.jl:36
  [7] Effective GPU memory usage: 99.98% (79.231 GiB/79.251 GiB)
Memory pool usage: 78.079 GiB (78.812 GiB reserved)

Stacktrace:
  [1] _pool_alloc
    @ ~/.julia/packages/CUDA/ja0IX/src/memory.jl:666 [inlined]
  [2] macro expansion
    @ ~/.julia/packages/CUDA/ja0IX/src/memory.jl:623 [inlined]
  [3] macro expansion
    @ ./timing.jl:395 [inlined]
  [4] pool_alloc
    @ ~/.julia/packages/CUDA/ja0IX/src/memory.jl:622 [inlined]
  [5] (::CUDA.var"#1140#1142"{CUDA.DeviceMemory, Int64})()
    @ CUDA ~/.julia/packages/CUDA/ja0IX/src/array.jl:92
  [6] cached_alloc(f::CUDA.var"#1140#1142"{CUDA.DeviceMemory, Int64}, key::Tuple{UnionAll, CUDA.CuDevice, DataType, Int64})
    @ GPUArrays ~/.julia/packages/GPUArrays/uiVyU/src/host/alloc_cache.jl:36
  [7] CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}(::UndefInitializer, dims::Tuple{Int64, Int64, Int64})
    @ CUDA ~/.julia/packages/CUDA/ja0IX/src/array.jl:91
  [8] CuArray
    @ ~/.julia/packages/CUDA/ja0IX/src/array.jl:142 [inlined]
  [9] CuArray
    @ ~/.julia/packages/CUDA/ja0IX/src/array.jl:158 [inlined]
 [10] zeros
    @ ~/.julia/packages/CUDA/ja0IX/src/array.jl:826 [inlined]
 [11] zeros(::CUDA.CUDAKernels.CUDABackend, ::Type{Float64}, dims::Tuple{Int64, Int64, Int64})
    @ CUDA.CUDAKernels ~/.julia/packages/CUDA/ja0IX/src/CUDAKernels.jl:25
 [12] zeros(::CUDA.CUDAKernels.CUDABackend, ::Type, ::Int64, ::Int64, ::Vararg{Int64})
    @ KernelAbstractions ~/.julia/packages/KernelAbstractions/C3nYQ/src/KernelAbstractions.jl:550
 [13] zeros(::GPU{CUDA.CUDAKernels.CUDABackend}, ::Type, ::Int64, ::Vararg{Int64})
    @ Oceananigans.Grids ~/.julia/packages/Oceananigans/TXJRi/src/Grids/zeros_and_ones.jl:9
 [14] zeros(::Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}, ::Type, ::Int64, ::Vararg{Int64})
    @ Oceananigans.DistributedComputations ~/.julia/packages/Oceananigans/TXJRi/src/DistributedComputations/distributed_architectures.jl:320
 [15] new_data(FT::DataType, arch::Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}, loc::Tuple{DataType, DataType, DataType}, topo::Tuple{DataType, DataType, DataType}, sz::Tuple{Int64, Int64, Int64}, halo_sz::Tuple{Int64, Int64, Int64}, indices::Tuple{Colon, Colon, Colon})
    @ Oceananigans.Grids ~/.julia/packages/Oceananigans/TXJRi/src/Grids/new_data.jl:67
 [16] new_data
    @ ~/.julia/packages/Oceananigans/TXJRi/src/Grids/new_data.jl:72 [inlined]
 [17] similar(f::Field{Center, Center, Face, Nothing, RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, Float64, FieldBoundaryConditions{Oceananigans.BoundaryConditions.DistributedCommunicationBoundaryCondition{Oceananigans.BoundaryConditions.DistributedCommunication, Oceananigans.DistributedComputations.HaloCommunicationRanks{Int64, Int64}}, Oceananigans.BoundaryConditions.DistributedCommunicationBoundaryCondition{Oceananigans.BoundaryConditions.DistributedCommunication, Oceananigans.DistributedComputations.HaloCommunicationRanks{Int64, Int64}}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.DistributedComputations.CommunicationBuffers{@NamedTuple{send::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}, recv::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, @NamedTuple{send::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}, recv::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, grid::RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}})
    @ Oceananigans.Fields ~/.julia/packages/Oceananigans/TXJRi/src/Fields/field.jl:239
 [18] similar
    @ ~/.julia/packages/Oceananigans/TXJRi/src/Fields/field.jl:238 [inlined]
 [19] map
    @ ./tuple.jl:293 [inlined]
 [20] map
    @ ./namedtuple.jl:265 [inlined]
 [21] TimeStepper(::Val{:RungeKutta3}, ::RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}}, ::Vararg{Any}; kwargs::@Kwargs{implicit_solver::Nothing})
    @ Oceananigans.TimeSteppers ~/.julia/packages/Oceananigans/TXJRi/src/TimeSteppers/TimeSteppers.jl:64
 [22] TimeStepper(::Symbol, ::RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}}, ::Vararg{Any}; kwargs::@Kwargs{implicit_solver::Nothing})
    @ Oceananigans.TimeSteppers ~/.julia/packages/Oceananigans/TXJRi/src/TimeSteppers/TimeSteppers.jl:55
 [23] NonhydrostaticModel(; grid::RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}}, clock::Clock{Float64, Float64, Int64, Int64}, advection::WENO{3, Float64, Float32, Nothing, WENO{2, Float64, Float32, Nothing, UpwindBiased{1, Float64, Nothing, Centered{1, Float64, Nothing}}, Centered{1, Float64, Nothing}}, Centered{2, Float64, Centered{1, Float64, Nothing}}}, buoyancy::Nothing, coriolis::Nothing, stokes_drift::Nothing, forcing::@NamedTuple{}, closure::ScalarDiffusivity{Oceananigans.TurbulenceClosures.ExplicitTimeDiscretization, Oceananigans.TurbulenceClosures.ThreeDimensionalFormulation, 1, Float64, Float64}, boundary_conditions::@NamedTuple{}, tracers::Tuple{}, timestepper::Symbol, background_fields::@NamedTuple{}, particles::Nothing, biogeochemistry::Nothing, velocities::Nothing, hydrostatic_pressure_anomaly::Oceananigans.Models.NonhydrostaticModels.DefaultHydrostaticPressureAnomaly, nonhydrostatic_pressure::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, Float64, FieldBoundaryConditions{Oceananigans.BoundaryConditions.DistributedCommunicationBoundaryCondition{Oceananigans.BoundaryConditions.DistributedCommunication, Oceananigans.DistributedComputations.HaloCommunicationRanks{Int64, Int64}}, Oceananigans.BoundaryConditions.DistributedCommunicationBoundaryCondition{Oceananigans.BoundaryConditions.DistributedCommunication, Oceananigans.DistributedComputations.HaloCommunicationRanks{Int64, Int64}}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.DistributedComputations.CommunicationBuffers{@NamedTuple{send::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}, recv::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, @NamedTuple{send::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}, recv::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, diffusivity_fields::Nothing, pressure_solver::Nothing, auxiliary_fields::@NamedTuple{})
    @ Oceananigans.Models.NonhydrostaticModels ~/.julia/packages/Oceananigans/TXJRi/src/Models/NonhydrostaticModels/nonhydrostatic_model.jl:227
 [24] top-level scope
    @ /fs1/home/ceoas/carlipp/multigpu-ocean/ngpu-scaling/2gpu-mpi.jl:43
in expression starting at /fs1/home/ceoas/carlipp/multigpu-ocean/ngpu-scaling/2gpu-mpi.jl:43
CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}(::UndefInitializer, dims::Tuple{Int64, Int64, Int64})
    @ CUDA ~/.julia/packages/CUDA/ja0IX/src/array.jl:91
  [8] CuArray
    @ ~/.julia/packages/CUDA/ja0IX/src/array.jl:142 [inlined]
  [9] CuArray
    @ ~/.julia/packages/CUDA/ja0IX/src/array.jl:158 [inlined]
 [10] zeros
    @ ~/.julia/packages/CUDA/ja0IX/src/array.jl:826 [inlined]
 [11] zeros(::CUDA.CUDAKernels.CUDABackend, ::Type{Float64}, dims::Tuple{Int64, Int64, Int64})
    @ CUDA.CUDAKernels ~/.julia/packages/CUDA/ja0IX/src/CUDAKernels.jl:25
 [12] zeros(::CUDA.CUDAKernels.CUDABackend, ::Type, ::Int64, ::Int64, ::Vararg{Int64})
    @ KernelAbstractions ~/.julia/packages/KernelAbstractions/C3nYQ/src/KernelAbstractions.jl:550
 [13] zeros(::GPU{CUDA.CUDAKernels.CUDABackend}, ::Type, ::Int64, ::Vararg{Int64})
    @ Oceananigans.Grids ~/.julia/packages/Oceananigans/TXJRi/src/Grids/zeros_and_ones.jl:9
 [14] zeros(::Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}, ::Type, ::Int64, ::Vararg{Int64})
    @ Oceananigans.DistributedComputations ~/.julia/packages/Oceananigans/TXJRi/src/DistributedComputations/distributed_architectures.jl:320
 [15] new_data(FT::DataType, arch::Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}, loc::Tuple{DataType, DataType, DataType}, topo::Tuple{DataType, DataType, DataType}, sz::Tuple{Int64, Int64, Int64}, halo_sz::Tuple{Int64, Int64, Int64}, indices::Tuple{Colon, Colon, Colon})
    @ Oceananigans.Grids ~/.julia/packages/Oceananigans/TXJRi/src/Grids/new_data.jl:67
 [16] new_data
    @ ~/.julia/packages/Oceananigans/TXJRi/src/Grids/new_data.jl:72 [inlined]
 [17] similar(f::Field{Center, Center, Face, Nothing, RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, Float64, FieldBoundaryConditions{Oceananigans.BoundaryConditions.DistributedCommunicationBoundaryCondition{Oceananigans.BoundaryConditions.DistributedCommunication, Oceananigans.DistributedComputations.HaloCommunicationRanks{Int64, Int64}}, Oceananigans.BoundaryConditions.DistributedCommunicationBoundaryCondition{Oceananigans.BoundaryConditions.DistributedCommunication, Oceananigans.DistributedComputations.HaloCommunicationRanks{Int64, Int64}}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.DistributedComputations.CommunicationBuffers{@NamedTuple{send::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}, recv::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, @NamedTuple{send::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}, recv::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, grid::RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}})
    @ Oceananigans.Fields ~/.julia/packages/Oceananigans/TXJRi/src/Fields/field.jl:239
 [18] similar
    @ ~/.julia/packages/Oceananigans/TXJRi/src/Fields/field.jl:238 [inlined]
 [19] map
    @ ./tuple.jl:293 [inlined]
 [20] map
    @ ./namedtuple.jl:265 [inlined]
 [21] TimeStepper(::Val{:RungeKutta3}, ::RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}}, ::Vararg{Any}; kwargs::@Kwargs{implicit_solver::Nothing})
    @ Oceananigans.TimeSteppers ~/.julia/packages/Oceananigans/TXJRi/src/TimeSteppers/TimeSteppers.jl:64
 [22] TimeStepper(::Symbol, ::RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}}, ::Vararg{Any}; kwargs::@Kwargs{implicit_solver::Nothing})
    @ Oceananigans.TimeSteppers ~/.julia/packages/Oceananigans/TXJRi/src/TimeSteppers/TimeSteppers.jl:55
 [23] NonhydrostaticModel(; grid::RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}}, clock::Clock{Float64, Float64, Int64, Int64}, advection::WENO{3, Float64, Float32, Nothing, WENO{2, Float64, Float32, Nothing, UpwindBiased{1, Float64, Nothing, Centered{1, Float64, Nothing}}, Centered{1, Float64, Nothing}}, Centered{2, Float64, Centered{1, Float64, Nothing}}}, buoyancy::Nothing, coriolis::Nothing, stokes_drift::Nothing, forcing::@NamedTuple{}, closure::ScalarDiffusivity{Oceananigans.TurbulenceClosures.ExplicitTimeDiscretization, Oceananigans.TurbulenceClosures.ThreeDimensionalFormulation, 1, Float64, Float64}, boundary_conditions::@NamedTuple{}, tracers::Tuple{}, timestepper::Symbol, background_fields::@NamedTuple{}, particles::Nothing, biogeochemistry::Nothing, velocities::Nothing, hydrostatic_pressure_anomaly::Oceananigans.Models.NonhydrostaticModels.DefaultHydrostaticPressureAnomaly, nonhydrostatic_pressure::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Oceananigans.Grids.FullyConnected, Periodic, Periodic, Oceananigans.Grids.StaticVerticalDiscretization{OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64}, Float64, Float64, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, OffsetArrays.OffsetVector{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Distributed{GPU{CUDA.CUDAKernels.CUDABackend}, false, Partition{Int64, Nothing, Nothing}, Tuple{Int64, Int64, Int64}, Int64, Tuple{Int64, Int64, Int64}, Oceananigans.DistributedComputations.NeighboringRanks{Int64, Int64, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}, MPI.Comm, Vector{MPI.Request}, Base.RefValue{Int64}, Nothing}}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, Float64, FieldBoundaryConditions{Oceananigans.BoundaryConditions.DistributedCommunicationBoundaryCondition{Oceananigans.BoundaryConditions.DistributedCommunication, Oceananigans.DistributedComputations.HaloCommunicationRanks{Int64, Int64}}, Oceananigans.BoundaryConditions.DistributedCommunicationBoundaryCondition{Oceananigans.BoundaryConditions.DistributedCommunication, Oceananigans.DistributedComputations.HaloCommunicationRanks{Int64, Int64}}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Periodic, Nothing}, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.DistributedComputations.CommunicationBuffers{@NamedTuple{send::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}, recv::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, @NamedTuple{send::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}, recv::CUDA.CuArray{Float64, 3, CUDA.DeviceMemory}}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, diffusivity_fields::Nothing, pressure_solver::Nothing, auxiliary_fields::@NamedTuple{})
    @ Oceananigans.Models.NonhydrostaticModels ~/.julia/packages/Oceananigans/TXJRi/src/Models/NonhydrostaticModels/nonhydrostatic_model.jl:227
 [24] top-level scope
    @ /fs1/home/ceoas/carlipp/multigpu-ocean/ngpu-scaling/2gpu-mpi.jl:43
in expression starting at /fs1/home/ceoas/carlipp/multigpu-ocean/ngpu-scaling/2gpu-mpi.jl:43
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpiexec detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[37209,1],0]
  Exit code:    1
--------------------------------------------------------------------------
